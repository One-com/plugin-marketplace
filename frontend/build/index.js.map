{"version":3,"file":"index.js","mappings":"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","sources":["webpack://MarketPlaceWP/./src/MarketplaceApp.jsx","webpack://MarketPlaceWP/./src/components/MarketPlace.jsx","webpack://MarketPlaceWP/./src/components/PluginActions.jsx","webpack://MarketPlaceWP/./src/components/normalised-plugins.jsx","webpack://MarketPlaceWP/external window \"React\"","webpack://MarketPlaceWP/external window \"ReactDOM\"","webpack://MarketPlaceWP/webpack/bootstrap","webpack://MarketPlaceWP/webpack/runtime/compat get default export","webpack://MarketPlaceWP/webpack/runtime/define property getters","webpack://MarketPlaceWP/webpack/runtime/hasOwnProperty shorthand","webpack://MarketPlaceWP/webpack/runtime/make namespace object","webpack://MarketPlaceWP/./src/index.wp.jsx"],"sourcesContent":["import React from \"react\";\nimport Marketplace from \"./components/MarketPlace\";\n\nconst MarketplaceApp = ({ apiBaseUrl, useWPHandlers, wpConfig, enableDefaultStyles }) => {\n    return (\n        <div className=\"marketplace-container gv-p-lg\">\n            <h2>Available Plugins</h2>\n            <Marketplace\n                apiBaseUrl={apiBaseUrl}\n                useWPHandlers={useWPHandlers}\n                wpConfig={wpConfig}\n                enableDefaultStyles={enableDefaultStyles}\n            />\n        </div>\n    );\n};\n\nexport default MarketplaceApp;\n","import React, { useState, useEffect } from \"react\";\nimport {normalizePlugins} from \"./normalised-plugins\";\nimport PluginActions from \"./PluginActions\";\n\nexport default function Marketplace({ apiBaseUrl, useWPHandlers, wpConfig, enableDefaultStyles }) {\n    const [plugins, setPlugins] = useState([]);\n    const [loading, setLoading] = useState(true);\n    const [pluginInAction, setPluginInAction] = useState({});\n\n    useEffect(() => {\n        async function fetchPlugins() {\n            try {\n                const res = await fetch(`${apiBaseUrl}`);\n                const json = await res.json();\n                const normalized = normalizePlugins(json);\n                setPlugins(normalized);\n            } catch (e) {\n                console.error(\"Failed to fetch plugins\", e);\n            } finally {\n                setLoading(false);\n            }\n        }\n\n        fetchPlugins();\n    }, [apiBaseUrl, useWPHandlers, wpConfig]);\n\n    const handlePluginAction = async (action, plugin) => {\n        setPluginInAction(prev => ({ ...prev, [plugin.slug]: true }));\n\n        try {\n            let url = `${apiBaseUrl}/${action}/${plugin.slug}`;\n\n            // prepare encoded download param (safe if plugin.download is undefined)\n            const downloadParam = `download_url=${encodeURIComponent(plugin.download || '')}`;\n\n            if (useWPHandlers) {\n                // original WP-AJAX URL + download_url appended\n                url = `${wpConfig.ajax_url}?action=marketplace_${action}_plugin&_wpnonce=${wpConfig.nonce}&slug=${plugin.slug}&${downloadParam}`;\n            } else {\n                // append download_url to non-WP URL (adds ? or & correctly)\n                url = url + (url.includes('?') ? '&' : '?') + downloadParam;\n            }\n\n            const res = await fetch(url, { method: \"POST\" });\n            const result = await res.json();\n\n            if (result.success) {\n                setPlugins(prev =>\n                    prev.map(p =>\n                        p.slug === plugin.slug\n                            ? { ...p, installed: result.data.installed, activated: result.data.activated }\n                            : p\n                    )\n                );\n            } else {\n                alert(result.data?.message || \"Failed to perform action\");\n            }\n        } catch (err) {\n            console.error(\"Plugin action failed\", err);\n        } finally {\n            setPluginInAction(prev => ({ ...prev, [plugin.slug]: false }));\n        }\n    };\n\n    if (loading) return <p>Loading plugins...</p>;\n\n    return (\n        <div className=\"marketplace gv-grid gv-gap-lg gv-tab-grid-cols-1 gv-desk-grid-cols-2 gv-mt-md\">\n            {plugins.map(plugin => (\n                <div id={`plugin-${plugin.slug}`} className=\"gv-card oc-plugins-box gv-surface-bright gv-pb-lg\">\n                    <div className=\"gv-card-illustration\">\n                        <img className=\"gv-tile\" src={plugin.thumbnail} alt={plugin.name} width=\"72\"\n                             height=\"72\"/>\n                    </div>\n                    <div key={plugin.slug} className='gv-card-content'>\n\n                        <h3 className=\"gv-card-title\">{plugin.name}</h3>\n                        <p>{plugin.description ? plugin.description : plugin.shortDescription} &nbsp;&nbsp;\n                        </p>\n                    </div>\n                    {useWPHandlers === true &&\n                    <PluginActions\n                        plugin={plugin}\n                        pluginInAction={pluginInAction}\n                        onAction={handlePluginAction}\n                    />\n                    }\n                </div>\n            ))}\n        </div>\n    );\n}","import React from \"react\";\n\nexport default function PluginActions({ plugin, pluginInAction, onAction }) {\n    const handleClick = (action) => {\n        onAction(action, plugin);\n    };\n\n    return (\n        <div className=\"plugin-actions gv-card-content gv-flex gv-gap-sm gv-mt-md\">\n            {plugin.installed ? (\n                plugin.activated ? (\n                    <button\n                        className=\"gv-button gv-button-secondary\"\n                        disabled={pluginInAction[plugin.slug]}\n                        onClick={() => handleClick(\"deactivate\")}\n                    >\n                        {pluginInAction[plugin.slug]\n                            ? marketplaceConfig.labels.deactivating\n                            : marketplaceConfig.labels.deactivate}\n                    </button>\n                ) : (\n                    <button\n                        className=\"gv-button gv-button-primary\"\n                        disabled={pluginInAction[plugin.slug]}\n                        onClick={() => handleClick(\"activate\")}\n                    >\n                        {pluginInAction[plugin.slug]\n                            ? marketplaceConfig.labels.activating\n                            : marketplaceConfig.labels.activate}\n                    </button>\n                )\n            ) : (\n                <button\n                    className=\"gv-button gv-button-secondary\"\n                    disabled={pluginInAction[plugin.slug]}\n                    onClick={() => handleClick(\"install\")}\n                >\n                    {pluginInAction[plugin.slug]\n                        ? marketplaceConfig.labels.installing\n                        : marketplaceConfig.labels.install}\n                </button>\n            )}\n        </div>\n    );\n}","export function normalizePlugins(rawResponse) {\n  if (!rawResponse || !rawResponse.data?.ui_json) return [];\n\n  return rawResponse.data.ui_json.map((plugin) => {\n    return {\n      ...plugin, // spread first ✅\n      name: plugin.name || \"Unknown\",\n      slug: plugin.slug || \"\",\n      price: plugin.price || \"\",\n      author: plugin.author || \"\",\n      version: plugin.version || \"\",\n      download: plugin.download || \"\",\n      thumbnail: plugin.thumbnail || \"\",\n      description: typeof plugin.description === \"object\"\n          ? plugin.description[\"en-gb\"] || Object.values(plugin.description)[0] || \"\"\n          : (plugin.description || \"\"),\n      installed: plugin.installed ?? false,\n      activated: plugin.activated ?? false,\n    };\n  });\n}","module.exports = window[\"React\"];","module.exports = window[\"ReactDOM\"];","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","import React from \"react\";\nimport { createRoot } from \"react-dom\";\nimport MarketplaceApp from \"./MarketplaceApp\";\n\n// Inside-WP auto-mount\ndocument.addEventListener(\"DOMContentLoaded\", () => {\n    const el = document.getElementById(\"marketplace-root\");\n    if (el) {\n        const config = window.marketplaceConfig || {};\n        const root = createRoot(el);\n        root.render(<MarketplaceApp {...config} />);\n    }\n});"],"names":["React","Marketplace","MarketplaceApp","apiBaseUrl","useWPHandlers","wpConfig","enableDefaultStyles","createElement","className","useState","useEffect","normalizePlugins","PluginActions","plugins","setPlugins","loading","setLoading","pluginInAction","setPluginInAction","fetchPlugins","res","fetch","json","normalized","e","console","error","handlePluginAction","action","plugin","prev","slug","url","downloadParam","encodeURIComponent","download","ajax_url","nonce","includes","method","result","success","map","p","installed","data","activated","alert","message","err","id","src","thumbnail","alt","name","width","height","key","description","shortDescription","onAction","handleClick","disabled","onClick","marketplaceConfig","labels","deactivating","deactivate","activating","activate","installing","install","rawResponse","ui_json","_plugin$installed","_plugin$activated","price","author","version","Object","values","createRoot","document","addEventListener","el","getElementById","config","window","root","render"],"sourceRoot":""}